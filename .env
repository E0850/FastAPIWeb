
# --- Environment ---
ENV=prod
CORS_ORIGINS=https://your-frontend.example.com,https://admin.example.com,http://localhost:5173,http://localhost:3000

# --- Database ---
# IMPORTANT: use a real ampersand (&), not &amp;
DB_URL=postgresql+psycopg2://neondb_owner:npg_k1muY4qVMbUI@ep-proud-leaf-afdhzdfz-pooler.c-2.us-west-2.aws.neon.tech/BugzyTestAPIDB?sslmode=require&channel_binding=require

# --- Auth / JWT ---
JWT_ACTIVE_KID=2025-01

# Base64-encoded PEM values (single-line, no quotes)
JWT_RS256_PRIVATE_KEY_B64__2025-01=LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2QUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktZd2dnU2lBZ0VBQW9JQkFRQ3pNQlg1MnNjYUZoTVAKcFpyQnhwYmNFejMzeWpXZU9SQUp6UW9meXJlRDFXYjk3Ly9ldko3VnhQZmhTUVk2YURzK0hpVjN1b3gwd0JQbwpDMzZ3NVZzejBxSHhQL2c1SVEwYXo3RG1hRUJTNXpCSlVLL2VXNlU4aTZ2Y2dwTFRVaURHMXBZc0N3NTJTd2NPClF6U0tGbHBmNFVDZHQxSlBsQWIrelBqK1ZIalphOWk0elE0dU8wTmhFYzhBMmdDZVhqQlZxemJ1eFB2NzJoMzIKajR4Vm9oL1ZtUkxNM3BSYjhRUFkxRitXU1RQZy9oUVA4cnlJMmphd3B3ZVFDdkc5cFQxazZmSmFlRGk2MjRDdgo2NlZtalVocGZoOEh1cjFYeWhFNlA5WWphUk5YeFFUT0w4MjhIUTYxTTlMWVRBTnRUWWtNZ2lpSEJjK1JucG1tCkxZWjFJVHFKQWdNQkFBRUNnZ0VBQlZrV0R0TDh4a2FLWXhrcU9VWllFbEZ3dEFpUStSdnk0cGdBQ1ZyZmgwdkQKT3lrQ2xmOURMbFltbjg2eUpPUWZnSWNkenlqK01DM2JhajJObG5JQit0WDZoMXpGWjg4WXVRZ2gyMzZaRE9CaApqSTZmOFI4REczOS9yYUVvQ0s2VzA5aHJ1dnpKZmJaWGk1RnQ3QUVteVYzTHMrbFl4NDgvZGpOZjZ4ZFNWQXJiCktiVlF1MlJ4SXhiai8vclAwUWNzeHl6b0dXMWlLb3orQ1l1VmttQThzTmlQM3p1djFqMlJwUG9yNm1QQWNlbzAKN05sdzB6NExZUWNIMUQ0T2pWY20rald4dVhaNHR1MW5BV3JFdU4yMmtCQXV3dFVITWZ2VktyMjFQWUxXWGN4eQp4VTZLVmFudlltSWhFcSt1TE9FSTViQWk4TzlsWU1oL0tQOTVzQ1Vxa1FLQmdRRGtCZWNlNmU2bVRPSHh5U1gwCmx3dlh0ZnJFeklZNTEybE1KbkxITUlSbXp5dSt2dUNCaWVMNDBjVnFTTkNRa1lyRWhnRncwNVNXUW45c25WMkgKUDFJcm9oUGJWcVRkVkJTbk1UVXZRSWJqQmJZWUljd1YxNWJQUGFmNzRBZDBBdUFhTFd2UXhHbnprVDZGV2NVYwpiNllMUk10eVlqK1Rpb0thbG16Z1lzeENZd0tCZ1FESkxFcW5jOGtrTlNvNWdTYTVWWFV2ZTFpVy8zKzZURmFSCkZwTXpXY0V1ckwzYkppSExYckp4VGNIaVllNlU5UTd5ZWUxcGRZMEJad2liQ3drd2RqK29XeGVKeG94bHNGRE8KSWRGbmliSzFRV1MyWjhyS0xxaWpCaW5xbUM1VmJyT2hvUjRVZjhkaTBoZG5DalVlN3hsaXVYR0dYUUlpNEIrcgpHbWJHbEZCdEl3S0JnR0d0amFZV2U5N05USFN3d0F1WXNNQUUrcGxYSzZDWGdFbllwbzVoWURaU1JPRC9EMWt1CllnWkloaExUZ2xTTHBEQXZYMnFmbUNVTjgxdnB4V2pzWFJ6SDMwMjBQZ2Q1dnljbjB5cWNyNnVNaE1hdG82a3YKb3pDL3JyZ2M3ZFJxYnVtSHo0bXN1ZDVXdDd1VUN2WDFkZUdaNUxUcEZXYjBqS0lBRWovRTBzOFZBb0dBTkY0WApRT2ZmSUZIR29CbUNueFFqNFN4V3IxZnJRKy9EU1JsN1VBNjVQeEV3aXUrdU5HWitSUWhjeERXQ0NieVJHNFdwCnk1NFNDcDlybWhDUlg5QW9XZ2I4WlowTnh4clNyaFlYa01CRGlQTnc2QnEwcTFUaUNTMzlrMWZ5RjhNdGQ1R2QKWnZDc1Vva21GbWlOMDNPaVJCVEovSlFSamtxUmM5VDNsQkhmcmNrQ2dZQVVDc0R2UGZpS1hvNWJjYkljRFF0NwpNbmJuOWxNN1pENGx2NGorUjVTZWlNYjMyYVBkUlExMW13eTlIVmpGMU5nNDV5S1gzWXZBYVNTNjBwZE9XNHkxClVEOVhzM3JiZG5IRHRpNExINTYrSk41eWVoSFBVNDZ3WGQ5djNHZWpuSUVNMXRrNUM4bmVGaDNGVG1zZnJVZmsKeVY3amJPMFFoNGRoY2NSMVF3VkY2dz09Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
JWT_RS256_PUBLIC_KEY_B64__2025-01=LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFzekFWK2RySEdoWVRENldhd2NhVwozQk05OThvMW5qa1FDYzBLSDhxM2c5Vm0vZS8vM3J5ZTFjVDM0VWtHT21nN1BoNGxkN3FNZE1BVDZBdCtzT1ZiCk05S2g4VC80T1NFTkdzK3c1bWhBVXVjd1NWQ3YzbHVsUEl1cjNJS1MwMUlneHRhV0xBc09ka3NIRGtNMGloWmEKWCtGQW5iZFNUNVFHL3N6NC9sUjQyV3ZZdU0wT0xqdERZUkhQQU5vQW5sNHdWYXMyN3NUNys5b2Q5bytNVmFJZgoxWmtTek42VVcvRUQyTlJmbGtrejRQNFVEL0s4aU5vMnNLY0hrQXJ4dmFVOVpPbnlXbmc0dXR1QXIrdWxabzFJCmFYNGZCN3E5VjhvUk9qL1dJMmtUVjhVRXppL052QjBPdFRQUzJFd0RiVTJKRElJb2h3WFBrWjZacGkyR2RTRTYKaVFJREFRQUIKLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0tCg==

# --- Token Lifetimes ---
TOKEN_EXPIRES_MIN=15
REFRESH_EXPIRES_DAYS=14

# --- Behavior ---
REFRESH_IN_COOKIE=false
REFRESH_COOKIE_NAME=refresh_token
REFRESH_COOKIE_SECURE=true
REFRESH_COOKIE_SAMESITE=strict
OPEN_USER_REGISTRATION=false
SEED_DEFAULT_USER=false
REQUIRE_CLIENT_AUTH=true
LOGIN_COOLDOWN_AFTER_429_SEC=60

# --- Okta (confirmed domain) ---
OKTA_ISSUER=https://integrator-4349888.okta.com/oauth2/default
OKTA_METADATA_URL=https://integrator-4349888.okta.com/oauth2/default/.well-known/openid-configuration
OKTA_CLIENT_ID=0oayp9nuc0ZHdTAey697
OKTA_CLIENT_SECRET=ETDMIMi0SthrIITMQ6YVmya3-tNA91feEUgklPu6lfHcAJ8SjOzzTLJAYFJISlic
OKTA_REDIRECT_URI=https://bugzyconnect.onrender.com/callback
OKTA_DEFAULT_SCOPES=openid profile email offline_access

# --- Optional (PKCE state store) ---
PKCE_DB_URL=sqlite:///./pkce_state.db
PKCE_STATE_TTL_SEC=600
